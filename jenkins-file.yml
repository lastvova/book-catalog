pipeline {
  agent any
  stages{
    
    stage ('Build') {
      steps {
        sh 'mvn clean package'
        }
      post {
          success {
            echo "Archiving..."
            archiveArtifacts artifacts:'**/target/*.war'
          }
      }
    }
      
    stage ('Deploy') {
      steps{
        build job:'deploy-book-catalog-to-staging'
        }
    }
      
    stage ('Deploy to prod') {
      steps{
        timeout(time:5, unit:'DAYS'){
          input message:'approve prod deploy'
        }
        build job:'deploy-book-catalog'
        }
    }
      
  }
}
